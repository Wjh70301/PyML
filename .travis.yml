sudo: false

language: c

os:
  - linux

#compiler:
#  - gcc

env:
  - CONDA_PY=3.5
  - CONDA_PY=3.6

matrix:
  include:
    - os: osx
      env:
        - CONDA_PY=3.5
      compiler:
        - clang
    - os: osx
      env:
        - CONDA_PY=3.6
      compiler:
        - clang

before_install:
  - source build_tools/travis/before_install.sh
  - eval "${MATRIX_EVAL}"

# Install packages
install:
  - source build_tools/travis/install_miniconda.sh
  - hash -r
  - conda config --set always_yes yes --set changeps1 no
  - conda update -q conda
  - conda install conda-build
  # Useful for debugging any issues with conda
  - conda info -a
  - conda create -q -n test-environment python=$CONDA_PY
  - source activate test-environment
  - pip install coveralls
  - pip install coverage
  - pip install codecov

script:
    - conda build --quiet --python=$CONDA_PY .
    - conda install pyml --use-local
#    - which gcc
    - coverage run setup.py test

after_success:
    - coveralls
    - codecov || echo "codecov upload failed"
